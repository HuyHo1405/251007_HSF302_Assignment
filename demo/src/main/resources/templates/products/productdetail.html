<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{layout/base :: head('Chi tiết sản phẩm')}"></head>
<body th:replace="~{layout/base :: layout(~{::content}, 'Chi tiết sản phẩm', 'Thông tin chi tiết sản phẩm đang chọn')}">
<main th:fragment="content">
    <div class="glass-card">
        <div class="row g-4 align-items-start">

            <div class="col-lg-5">
                <div class="glass-card text-center" style="min-height:340px;display:flex;align-items:center;justify-content:center">
                    <img th:src="${productdetail.imageUrl}"
                         th:alt="${productdetail.name}"
                         style="width: auto; max-height: 300px; object-fit: contain;"
                    />
                </div>
            </div>

            <div class="col-lg-7">
                <div class="d-flex flex-column gap-2 mb-3">
                    <span class="badge-outline"><i class="bi bi-tag"></i> <span th:text="${productdetail.brand}">Thương hiệu</span></span>
                    <h2 th:text="${productdetail.name}">Tên sản phẩm</h2>
                    <div class="product-meta text-secondary">
                        <span><i class="bi bi-bar-chart"></i> Model: <span th:text="${productdetail.model}">Model</span></span>
                        <span class="ms-3"><i class="bi bi-cpu"></i> Loại: <span th:text="${productdetail.type}">Loại</span></span>

                        <div class="product-meta">
                            <div class="meta-row">
                                <span class="meta-label">Bảo hành: </span>
                                <span class="meta-value" th:text="${productdetail.warrantyMonths} + ' tháng'">12</span>
                            </div>

                            <div class="meta-row">
                                <span class="meta-label">Trạng thái:</span>
                                <span class="meta-value">
      <span class="badge status-badge"
            th:classappend="${productdetail.status} == 'available' ? 'status-available' :
                            (${productdetail.status} == 'preorder' ? 'status-preorder' : 'status-other')"
            th:text="${productdetail.status}">Available</span>
    </span>
                            </div>

                    </div>
                    <div class="product-price" th:text="${#numbers.formatDecimal(productdetail.unitPrice, 0, 'COMMA', 0, 'POINT')} + ' ₫'"></div>
                </div>

                <div class="summary-item">
                    <h4><i class="bi bi-file-text me-2"></i>Mô tả sản phẩm</h4>
                    <p class="mb-0" th:text="${productdetail.description}">Nội dung mô tả sản phẩm.</p>
                </div>

                <form th:action="@{/cart/add}" method="post" class="glass-card mt-4">
                    <input type="hidden" name="productId" th:value="${productdetail.id}"/>
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <div class="d-flex flex-wrap align-items-center gap-3">
                        <label for="quantity" class="form-label mb-0">Số lượng</label>
                        <input type="number" class="form-control" style="max-width:120px" id="quantity" name="quantity" value="1" min="1" required>
                        <button type="submit" class="btn-primary">
                            <i class="bi bi-cart-plus"></i> Thêm vào giỏ hàng
                        </button>
                    </div>
                </form>

                <div class="d-flex gap-3 mt-4" sec:authorize="hasAnyRole('ADMIN','STAFF')">
                    <a th:href="@{/products/update/{id}(id=${productdetail.id})}" class="btn-secondary">
                        <i class="bi bi-pencil"></i> Sửa sản phẩm
                    </a>
<!--                    <form th:action="@{/products/delete/{id}(id=${productdetail.id})}" method="post"  onsubmit="return confirm('Xác nhận xóa sản phẩm này?')">-->
<!--                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>-->
<!--                        <button type="submit" class="btn-danger">-->
<!--                            <i class="bi bi-trash"></i> Xóa-->
<!--                        </button>-->
<!--                    </form>-->
                </div>

                <a href="/products/list" class="btn-secondary mt-4">
                    <i class="bi bi-arrow-left"></i> Quay lại danh sách
                </a>
            </div>
        </div>
    </div>
</main>
</body>
</html>