<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/base :: head('Chỉnh sửa sản phẩm trong đơn')}"></head>
<body th:replace="~{layout/base :: layout(~{::content}, 'Chỉnh sửa sản phẩm trong đơn hàng', 'Điều chỉnh số lượng và giá của sản phẩm thuộc đơn hàng')}">
<main th:fragment="content">
    <div class="glass-card mx-auto" style="max-width: 720px;">
        <div class="d-flex flex-column flex-lg-row justify-content-lg-between align-items-lg-center gap-3 mb-4">
            <div>
                <h2 class="mb-1"><i class="bi bi-pencil-square me-2"></i>Cập nhật sản phẩm</h2>
                <p class="text-secondary mb-0">Đơn hàng #<span th:text="${orderItem.orderId}">0</span></p>
            </div>
            <div class="chip">
                <i class="bi bi-box-seam"></i>
                <span>ID mục:</span>
                <strong th:text="${orderItem.id}">0</strong>
            </div>
        </div>

        <form th:action="@{/orders/{orderId}/items/{itemId}/edit(orderId=${orderItem.orderId}, itemId=${orderItem.id})}"
              th:object="${orderItem}"
              method="post"
              class="row g-3">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

            <div class="col-12">
                <label for="productId" class="form-label">
                    <i class="bi bi-grid me-1"></i>Chọn sản phẩm
                </label>
                <select th:field="*{productId}" id="productId" class="form-select" required>
                    <option value="">-- Chọn sản phẩm --</option>
                    <option th:each="product : ${products}"
                            th:value="${product.id}"
                            th:text="${product.name}">
                    </option>
                </select>
            </div>

            <div class="col-md-6">
                <label for="quantity" class="form-label">
                    <i class="bi bi-stack me-1"></i>Số lượng
                </label>
                <input type="number" th:field="*{quantity}" id="quantity" class="form-control" min="1" required/>
            </div>

            <div class="col-md-6">
                <label for="unitPrice" class="form-label">
                    <i class="bi bi-cash-stack me-1"></i>Đơn giá (₫)
                </label>
                <input type="number" th:field="*{unitPrice}" id="unitPrice" class="form-control" step="0.01" min="0" required/>
            </div>

            <div class="d-flex flex-column flex-md-row gap-3 mt-4">
                <button type="submit" class="btn-primary d-flex align-items-center justify-content-center gap-2">
                    <i class="bi bi-save"></i> Lưu thay đổi
                </button>
                <a th:href="@{/orders/{orderId}(orderId=${orderItem.orderId})}"
                   class="btn-secondary d-flex align-items-center justify-content-center gap-2">
                    <i class="bi bi-x-circle"></i> Hủy bỏ
                </a>
            </div>
        </form>
    </div>
</main>
</body>
</html>
