<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{layout/base :: head('Xác nhận đơn hàng')}"></head>
<body th:replace="~{layout/base :: layout(~{::content}, 'Xác nhận đơn hàng', 'Kiểm tra lại thông tin trước khi đặt hàng')}">
<main th:fragment="content">
    <div class="glass-card">
        <div class="text-center mb-4">
            <div class="avatar-ring mx-auto mb-3">
                <i class="bi bi-clipboard-check"></i>
            </div>
            <h2 class="mb-1">Xác nhận đơn hàng</h2>
            <p class="text-secondary mb-0">Vui lòng đọc kỹ thông tin trước khi nhấn xác nhận</p>
        </div>

        <div class="summary-grid">
            <div class="summary-item">
                <h4><i class="bi bi-person me-2"></i>Thông tin khách hàng</h4>
                <p class="mb-1"><strong>Họ tên:</strong> <span th:text="${order.userFullName}">---</span></p>
                <p class="mb-0"><strong>Số lượng sản phẩm:</strong> <span th:text="${order.items != null ? order.items.size() : 0}">0</span></p>
            </div>
            <div class="summary-item">
                <h4><i class="bi bi-receipt me-2"></i>Tổng quan đơn hàng</h4>
                <p class="mb-1"><strong>Tạm tính:</strong> <span th:text="${#numbers.formatDecimal(orderTotal, 0, 'COMMA', 0, 'POINT')} + ' ₫'"></span></p>
                <p class="mb-1"><strong>Phí vận chuyển:</strong> 0 ₫</p>
                <p class="mb-0"><strong>Tổng thanh toán:</strong> <span th:text="${#numbers.formatDecimal(orderTotal, 0, 'COMMA', 0, 'POINT')} + ' ₫'"></span></p>
            </div>
        </div>

        <section class="mt-5">
            <h3 class="mb-3"><i class="bi bi-box-seam me-2"></i>Sản phẩm trong đơn</h3>
            <div class="table-responsive">
                <table class="table-glass">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>Tên sản phẩm</th>
                        <th>Đơn giá</th>
                        <th>Số lượng</th>
                        <th>Thành tiền</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="item, iterStat : ${order.items}">
                        <td th:text="${iterStat.count}">1</td>
                        <td th:text="${item.productName}">Laptop</td>
                        <td th:text="${#numbers.formatDecimal(item.unitPrice, 0, 'COMMA', 0, 'POINT')} + ' ₫'"></td>
                        <td th:text="${item.quantity}"></td>
                        <td th:text="${#numbers.formatDecimal(item.subtotal, 0, 'COMMA', 0, 'POINT')} + ' ₫'"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <form th:action="@{/orders/create}" method="post" class="mt-5 text-center">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <div class="d-inline-flex flex-wrap gap-3 justify-content-center">
                <button type="submit" class="btn-primary btn-lg">
                    <i class="bi bi-check-circle"></i> Xác nhận đặt hàng
                </button>
                <a href="/cart" class="btn-secondary btn-lg">
                    <i class="bi bi-arrow-left"></i> Quay lại giỏ hàng
                </a>
            </div>
        </form>
    </div>
</main>
</body>
</html>